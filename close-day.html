<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ…</title>

<style>
body{font-family:Tahoma;background:#f1f5f9;margin:0}
header{background:#0f172a;color:#fff;padding:12px;text-align:center}
.box{background:#fff;margin:12px;padding:14px;border-radius:12px}
button{
width:100%;padding:14px;
font-size:16px;border:0;
border-radius:12px;
background:#22c55e;color:#fff
}
</style>
</head>

<body>

<header>ğŸ”’ Ù‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ…</header>

<div class="box" id="info"></div>
<div class="box">
<button onclick="closeDay()">Ù‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¢Ù†</button>
</div>

<script>
let invoices = JSON.parse(localStorage.invoices || "[]");
let dailyCloses = JSON.parse(localStorage.dailyCloses || "[]");

let today = new Date().toISOString().slice(0,10);

function calcToday(){
let todayInv = invoices.filter(i=>i.date.startsWith(today));
let total = todayInv.reduce((a,i)=>a+i.total,0);
let profit = todayInv.reduce((a,i)=>a+i.profit,0);
return {count:todayInv.length,total,profit};
}

let data = calcToday();

info.innerHTML = `
Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±: ${data.count}<br>
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: ${data.total}<br>
Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${data.profit}
`;

function closeDay(){
if(dailyCloses.find(d=>d.date===today)){
alert("ØªÙ… Ù‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„");
return;
}

dailyCloses.push({
date:today,
count:data.count,
total:data.total,
profit:data.profit
});

localStorage.dailyCloses = JSON.stringify(dailyCloses);
alert("ØªÙ… Ù‚ÙÙ„ Ø§Ù„ÙŠÙˆÙ… Ø¨Ù†Ø¬Ø§Ø­");
}
</script>

</body>
</html>
