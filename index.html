<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>POS System</title>

<style>
body{margin:0;font-family:Tahoma;background:#f1f5f9}
header{
 background:#020617;color:#fff;
 padding:12px;text-align:center;font-size:18px
}
nav{
 display:flex;gap:5px;
 background:#020617;padding:6px
}
nav button{
 flex:1;background:#111827;color:#fff;
 border:0;border-radius:8px;padding:10px
}
section{padding:10px}
input,select,button{
 width:100%;padding:10px;
 border-radius:8px;font-size:14px
}
button{border:0;cursor:pointer}
.btn{background:#16a34a;color:#fff}
.btn-danger{background:#dc2626;color:#fff}
.card{
 background:#fff;padding:10px;
 border-radius:10px;margin-bottom:6px
}
.hidden{display:none}

/* ÙƒØ§Ø´ÙŠØ± */
#invoice{
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
 gap:8px
}
#totalBox{
 background:#020617;color:#fff;
 padding:12px;border-radius:12px;
 text-align:center;font-size:18px
}

/* Ø·Ø¨Ø§Ø¹Ø© */
@media print{
 nav,button,input,select{display:none}
 body{background:#fff}
 .card{border:1px dashed #000}
}
</style>
</head>

<body>

<header>ğŸ§¾ Ù†Ø¸Ø§Ù… ÙƒØ§Ø´ÙŠØ±</header>

<nav>
 <button onclick="show('cashier')">ÙƒØ§Ø´ÙŠØ±</button>
 <button onclick="show('products')">Ø§Ù„Ø£ØµÙ†Ø§Ù</button>
 <button onclick="show('reports')">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
</nav>

<!-- ÙƒØ§Ø´ÙŠØ± -->
<section id="cashier">
 <input id="search" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
 <input id="qty" type="number" value="1">

 <select id="payType">
  <option value="cash">Ù†Ù‚Ø¯ÙŠ</option>
  <option value="credit">Ø¢Ø¬Ù„</option>
 </select>

 <button class="btn" onclick="addItem()">â• Ø¥Ø¶Ø§ÙØ©</button>

 <div id="invoice"></div>
 <div id="totalBox">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0</div>

 <button class="btn" onclick="saveAndPrint()">ğŸ’¾ Ø­ÙØ¸ ÙˆØ·Ø¨Ø§Ø¹Ø©</button>
</section>

<!-- Ø§Ù„Ø£ØµÙ†Ø§Ù -->
<section id="products" class="hidden">
 <h3>ğŸ“¦ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</h3>
 <input id="pn" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
 <input id="pp" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
 <input id="pc" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡">
 <input id="ps" placeholder="Ø§Ù„Ù…Ø®Ø²ÙˆÙ†">
 <button class="btn" onclick="addProduct()">Ø­ÙØ¸</button>

 <h3>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù</h3>
 <div id="plist"></div>
</section>

<!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
<section id="reports" class="hidden">
 <h3>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…</h3>
 <div id="reportBox"></div>
</section>

<script>
let products=JSON.parse(localStorage.products||"[]");
let invoices=JSON.parse(localStorage.invoices||"[]");
let cart=[];

function saveAll(){
 localStorage.products=JSON.stringify(products);
 localStorage.invoices=JSON.stringify(invoices);
}

function show(id){
 document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
}

function addProduct(){
 products.push({
  n:pn.value,
  p:+pp.value,
  c:+pc.value,
  s:+ps.value
 });
 saveAll();
 pn.value=pp.value=pc.value=ps.value="";
 renderProducts();
 alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙ†Ù");
}

function renderProducts(){
 plist.innerHTML="";
 products.forEach((p,i)=>{
  plist.innerHTML+=`
   <div class="card">
    ${p.n}<br>
    Ø¨ÙŠØ¹: ${p.p} | Ù…Ø®Ø²ÙˆÙ†: ${p.s}
   </div>`;
 });
}

function addItem(){
 let p=products.find(x=>x.n===search.value);
 if(!p) return alert("Ø§Ù„ØµÙ†Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
 if(p.s<qty.value) return alert("Ù†ÙØ§Ø¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†");

 cart.push({n:p.n,p:p.p,c:p.c,q:+qty.value});
 p.s-=qty.value;
 renderInvoice();saveAll();
}

function renderInvoice(){
 invoice.innerHTML="";let t=0;
 cart.forEach(i=>{
  t+=i.p*i.q;
  invoice.innerHTML+=`
   <div class="card">
    ${i.n}<br>${i.q} Ã— ${i.p}
   </div>`;
 });
 totalBox.innerText="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: "+t;
}

function saveAndPrint(){
 if(cart.length===0) return;
 let total=cart.reduce((a,i)=>a+i.p*i.q,0);
 let profit=cart.reduce((a,i)=>a+(i.p-i.c)*i.q,0);

 invoices.push({
  date:new Date().toLocaleDateString(),
  total,profit
 });

 saveAll();
 window.print();
 cart=[];renderInvoice();renderReport();
}

function renderReport(){
 let today=new Date().toLocaleDateString();
 let list=invoices.filter(i=>i.date===today);
 let total=list.reduce((a,i)=>a+i.total,0);
 let profit=list.reduce((a,i)=>a+i.profit,0);

 reportBox.innerHTML=`
  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: ${total}<br>
  Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${profit}
 `;
}

renderProducts();
renderReport();
</script>

</body>
</html>
