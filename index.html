<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>POS PRO</title>

<style>
:root{
  --main:#020617;
  --accent:#22c55e;
  --danger:#ef4444;
  --bg:#f1f5f9;
  --card:#ffffff;
}
*{box-sizing:border-box}
body{margin:0;font-family:Tahoma;background:var(--bg)}
header{background:var(--main);color:#fff;padding:14px;text-align:center;font-size:18px}

/* ===== LOGIN ===== */
#login{
  height:100vh;display:flex;align-items:center;justify-content:center;
}
.login-box{
  background:#fff;padding:20px;border-radius:16px;
  width:100%;max-width:320px;
  box-shadow:0 10px 30px rgba(0,0,0,.15)
}
.login-box h3{text-align:center;margin-bottom:15px}
.login-box input{
  width:100%;padding:12px;margin-bottom:10px;
  border-radius:10px;border:1px solid #cbd5e1;font-size:15px
}
.login-box button{
  width:100%;padding:12px;border:none;border-radius:12px;
  background:var(--accent);color:#fff;font-size:16px
}
.error{color:var(--danger);text-align:center;margin-top:8px}

/* ===== APP ===== */
#app{display:none}

/* NAV */
nav{
  display:grid;
  grid-template-columns:1fr 1fr 1fr 1fr;
  gap:6px;
  padding:8px;
  background:#fff;
}
nav button{
  padding:12px;border:none;border-radius:10px;font-size:14px;
  background:#e5e7eb;cursor:pointer
}
nav button.active{background:var(--accent);color:#fff}

/* TOP */
#top{
  display:grid;
  grid-template-columns:2fr 1fr 1fr;
  gap:8px;
  padding:10px;
  background:#fff;
}
#top input,#top button{
  padding:12px;border-radius:10px;border:1px solid #cbd5e1;font-size:15px
}
#top button{background:var(--accent);color:#fff;border:none}

/* PRODUCTS */
#products{
  padding:10px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:10px;
}
.product{
  background:var(--card);
  border-radius:14px;
  padding:12px;
  box-shadow:0 4px 10px rgba(0,0,0,.08);
  cursor:pointer;
}

/* INVOICE */
#invoice{
  background:#fff;padding:10px;border-top:2px solid #e5e7eb;
  position:sticky;bottom:0;
}
#items{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:8px}
.item{background:#f8fafc;padding:8px;border-radius:10px;text-align:center}
#summary{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-top:8px;font-weight:bold}
#actions{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
.save{background:var(--accent);color:#fff}
.clear{background:var(--danger);color:#fff}

/* SCREENS */
.screen{display:none}
.screen.active{display:block}

/* REPORTS */
.report{
  background:#fff;border-radius:14px;padding:14px;margin:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.08)
}
</style>
</head>

<body>

<!-- ===== LOGIN ===== -->
<div id="login">
  <div class="login-box">
    <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
    <input id="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <div id="err" class="error"></div>
  </div>
</div>

<!-- ===== APP ===== -->
<div id="app">

<header>
  Ù†Ø¸Ø§Ù… ÙƒØ§Ø´ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ
  <button style="float:left;background:none;border:none;color:#fff"
    onclick="logout()">Ø®Ø±ÙˆØ¬</button>
</header>

<nav>
  <button class="active" onclick="show('cashier',this)">Ø§Ù„ÙƒØ§Ø´ÙŠØ±</button>
  <button id="repBtn" onclick="show('reports',this)">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
  <button id="setBtn" onclick="show('settings',this)">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
  <button onclick="logout()">Ø®Ø±ÙˆØ¬</button>
</nav>

<!-- CASHIER -->
<div id="cashier" class="screen active">
  <div id="top">
    <input placeholder="Ø¨Ø­Ø«">
    <button onclick="addProduct()">â• ØµÙ†Ù</button>
    <button onclick="saveInvoice()">Ø­ÙØ¸</button>
  </div>
  <div id="products"></div>
  <div id="invoice">
    <div id="items"></div>
    <div id="summary">
      <div id="total">Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0</div>
      <div id="cost">ØªÙƒÙ„ÙØ©: 0</div>
      <div id="profit">Ø±Ø¨Ø­: 0</div>
    </div>
  </div>
</div>

<!-- REPORTS -->
<div id="reports" class="screen">
  <div class="report">
    <h3>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø¹Ø§Ù…</h3>
    <div id="rSales">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: 0</div>
    <div id="rProfit">Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: 0</div>
  </div>
</div>

<!-- SETTINGS -->
<div id="settings" class="screen">
  <div class="report">
    <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
    <button class="clear" onclick="resetAll()">Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
  </div>
</div>

</div>

<script>
/* ===== USERS ===== */
const users=[
  {u:"admin",p:"1234",role:"admin"},
  {u:"cashier",p:"1234",role:"cashier"}
];

/* ===== STORAGE ===== */
let products=JSON.parse(localStorage.products||"[]");
let invoices=JSON.parse(localStorage.invoices||"[]");
let cart=[];
let currentUser=JSON.parse(localStorage.user||"null");

/* ===== LOGIN ===== */
function login(){
  let u=user.value,p=pass.value;
  let found=users.find(x=>x.u===u && x.p===p);
  if(!found){err.innerText="Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©";return;}
  localStorage.user=JSON.stringify(found);
  location.reload();
}
function logout(){
  localStorage.removeItem("user");
  location.reload();
}

/* ===== INIT ===== */
if(currentUser){
  loginDiv.style.display="none";
  app.style.display="block";
  if(currentUser.role!=="admin"){
    repBtn.style.display="none";
    setBtn.style.display="none";
  }
}else{
  app.style.display="none";
}

/* ===== NAV ===== */
function show(id,btn){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

/* ===== PRODUCTS ===== */
if(products.length===0){
  products.push({n:"Ù…ÙŠØ§Ù‡",sell:5,buy:3,qty:50});
  saveAll();
}
const prodDiv=document.getElementById("products");
function renderProducts(){
  prodDiv.innerHTML="";
  products.forEach((p,i)=>{
    let d=document.createElement("div");
    d.className="product";
    d.innerHTML=`${p.n}<br>Ø¨ÙŠØ¹: ${p.sell}`;
    d.onclick=()=>addToCart(i);
    prodDiv.appendChild(d);
  });
}
renderProducts();

/* ===== CART ===== */
function addToCart(i){
  if(products[i].qty<=0)return;
  cart.push(products[i]);
  products[i].qty--;
  renderInvoice();saveAll();
}
function renderInvoice(){
  items.innerHTML="";
  let t=0,c=0;
  cart.forEach(i=>{
    t+=i.sell;c+=i.buy;
    items.innerHTML+=`<div class="item">${i.n}</div>`;
  });
  total.innerText="Ø¥Ø¬Ù…Ø§Ù„ÙŠ: "+t;
  cost.innerText="ØªÙƒÙ„ÙØ©: "+c;
  profit.innerText="Ø±Ø¨Ø­: "+(t-c);
}

/* ===== SAVE ===== */
function saveInvoice(){
  if(cart.length===0)return;
  let t=0,c=0;
  cart.forEach(i=>{t+=i.sell;c+=i.buy});
  invoices.push({total:t,profit:t-c});
  cart=[];renderInvoice();saveAll();calcReports();
}

/* ===== REPORT ===== */
function calcReports(){
  let s=0,p=0;
  invoices.forEach(i=>{s+=i.total;p+=i.profit});
  rSales.innerText="Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: "+s;
  rProfit.innerText="Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: "+p;
}
calcReports();

/* ===== ADD ===== */
function addProduct(){
  let n=prompt("Ø§Ø³Ù…"); if(!n)return;
  let sell=+prompt("Ø¨ÙŠØ¹"),buy=+prompt("Ø´Ø±Ø§Ø¡"),qty=+prompt("ÙƒÙ…ÙŠØ©");
  products.push({n,sell,buy,qty});
  saveAll();renderProducts();
}

/* ===== RESET ===== */
function resetAll(){
  if(confirm("Ù…Ø³Ø­ ÙƒÙ„ Ø´ÙŠØ¡ØŸ")){
    localStorage.clear();location.reload();
  }
}
function saveAll(){
  localStorage.products=JSON.stringify(products);
  localStorage.invoices=JSON.stringify(invoices);
}
</script>

</body>
</html>
