<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>POS | Ø§Ù„ÙƒØ§Ø´ÙŠØ±</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<style>
:root{
--main:#0f172a;
--green:#22c55e;
--blue:#0ea5e9;
--purple:#6366f1;
--bg:#f1f5f9;
--red:#ef4444;
}

body{
margin:0;
font-family:Tahoma;
background:var(--bg)
}

header{
background:linear-gradient(90deg,#020617,#0f172a);
color:#fff;
padding:12px;
text-align:center;
font-size:18px
}

.container{padding:10px}

/* Ø£Ø²Ø±Ø§Ø± Ø¹Ù„ÙˆÙŠØ© */
.top-buttons{
display:grid;
grid-template-columns:1fr 1fr;
gap:8px;
margin-bottom:10px
}

.top-buttons button{
padding:12px;
font-size:15px;
border:0;
border-radius:12px;
color:#fff;
cursor:pointer
}
.admin{background:var(--blue)}
.print{background:var(--purple)}

/* Ø¥Ø¯Ø®Ø§Ù„ */
.inputs{
background:#fff;
padding:10px;
border-radius:14px;
display:grid;
grid-template-columns:2fr 1fr 1fr 1fr;
gap:6px;
margin-bottom:10px
}

.inputs input,
.inputs button{
padding:12px;
font-size:15px;
border-radius:10px;
border:1px solid #cbd5f5
}

.inputs button{
background:var(--green);
color:#fff;
border:0
}

.scan-btn{
background:#000;
color:#fff;
font-size:18px
}

/* Ø§Ù„ÙØ§ØªÙˆØ±Ø© */
#invoice{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
gap:8px
}

.item{
background:#fff;
border-radius:14px;
padding:10px;
text-align:center;
box-shadow:0 4px 10px rgba(0,0,0,.08)
}

.item b{
display:block;
margin-bottom:6px
}

/* Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ */
.total{
margin-top:10px;
background:#fff;
padding:14px;
border-radius:14px;
font-size:22px;
text-align:center;
font-weight:bold
}

/* Ø­ÙØ¸ */
.save-btn{
margin-top:10px;
width:100%;
padding:14px;
font-size:18px;
background:var(--green);
color:#fff;
border:0;
border-radius:14px;
cursor:pointer
}

/* Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ */
#scanner{
display:none;
position:fixed;
top:0;left:0;
width:100%;
height:100%;
background:#000;
z-index:9999
}

#scanner button{
position:absolute;
top:10px;
right:10px;
padding:10px 14px;
background:var(--red);
color:#fff;
border:0;
border-radius:10px;
font-size:16px;
z-index:10
}

#camera{
width:100%;
height:100%
}
</style>
</head>

<body>

<header>ğŸ§¾ Ø´Ø§Ø´Ø© Ø§Ù„ÙƒØ§Ø´ÙŠØ±</header>

<div class="container">

<!-- Ø£Ø²Ø±Ø§Ø± -->
<div class="top-buttons">
<button class="admin" onclick="openAdmin()">âš™ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù</button>
<button class="print" onclick="printInvoice()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

<!-- Ø¥Ø¯Ø®Ø§Ù„ -->
<div class="inputs">
<input id="search" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù Ø£Ùˆ Ø¨Ø§Ø±ÙƒÙˆØ¯">
<input id="qty" type="number" value="1">
<button onclick="addItem()">â•</button>
<button class="scan-btn" onclick="startScanner()">ğŸ“·</button>
</div>

<!-- Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
<div id="invoice"></div>

<!-- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
<div class="total" id="total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0</div>

<button class="save-btn" onclick="saveInvoice()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>

</div>

<!-- Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
<div id="scanner">
<button onclick="stopScanner()">Ø¥ØºÙ„Ø§Ù‚</button>
<div id="camera"></div>
</div>

<!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ -->
<script src="https://unpkg.com/quagga/dist/quagga.min.js"></script>

<!-- ÙƒÙˆØ¯ Ø§Ù„Ù†Ø¸Ø§Ù… -->
<script src="core.js"></script>

<script>
/* ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ */
function startScanner(){
document.getElementById("scanner").style.display="block";

Quagga.init({
inputStream:{
type:"LiveStream",
target:document.querySelector('#camera'),
constraints:{ facingMode:"environment" }
},
decoder:{
readers:["ean_reader","code_128_reader"]
}
},function(err){
if(err){
alert("ØªØ¹Ø°Ø± ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§");
return;
}
Quagga.start();
});

Quagga.onDetected(function(data){
let code = data.codeResult.code;
document.getElementById("search").value = code;
stopScanner();
});
}

/* Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ */
function stopScanner(){
Quagga.stop();
document.getElementById("scanner").style.display="none";
}

/* Service Worker */
if('serviceWorker' in navigator){
navigator.serviceWorker.register('sw.js');
}
</script>

</body>
</html>
