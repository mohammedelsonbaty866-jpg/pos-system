<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>نظام كاشير احترافي</title>

<style>
body{margin:0;font-family:Tajawal,Arial;background:#f1f5f9}
header{background:#020617;color:#fff;padding:12px;display:flex;justify-content:space-between}
button{cursor:pointer}
.screen{display:none;padding:10px}
.screen.active{display:block}
.product{background:#fff;padding:10px;border-radius:10px;text-align:center}
.item{background:#e5e7eb;padding:6px;border-radius:6px}
</style>
</head>

<body>

<header>
 <span id="shopName">نظام كاشير</span>
 <button onclick="toggleMenu()">☰</button>
</header>

<div id="menu" style="position:fixed;right:-200px;top:0;background:#020617;color:#fff;width:200px;height:100%;padding:10px">
 <button onclick="showScreen('cashier')">الكاشير</button>
 <button onclick="showScreen('products')">الأصناف</button>
 <button onclick="showScreen('reports')">التقارير</button>
 <button onclick="showScreen('settings')">الإعدادات</button>
</div>

<div id="cashier" class="screen active">
 <div id="productsGrid"></div>
 <div id="invoiceItems"></div>
 <div id="total">الإجمالي: 0</div>
 <button onclick="saveInvoice()">حفظ</button>
 <button onclick="printInvoice()">طباعة</button>
</div>

<div id="products" class="screen">
 <input id="pn" placeholder="اسم الصنف">
 <input id="pp" type="number" placeholder="السعر">
 <button onclick="addProduct()">حفظ</button>
</div>

<div id="reports" class="screen">
 <button onclick="dailyReport()">تقرير اليوم</button>
 <div id="reportBox"></div>
</div>

<div id="settings" class="screen">
 <input id="shopInput" placeholder="اسم المحل">
 <button onclick="saveSettings()">حفظ</button>
</div>

<script>
let products=JSON.parse(localStorage.products||"[]");
let invoices=JSON.parse(localStorage.invoices||"[]");
let cart=[];
let settings=JSON.parse(localStorage.settings||"{}");

function toggleMenu(){
 menu.style.right=menu.style.right=="0px"?"-200px":"0px";
}
function showScreen(id){
 document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 menu.style.right="-200px";
}

function renderProducts(){
 productsGrid.innerHTML="";
 products.forEach(p=>{
  let d=document.createElement("div");
  d.className="product";
  d.innerText=p.n+" - "+p.p;
  d.onclick=()=>addToCart(p);
  productsGrid.appendChild(d);
 });
}

function addProduct(){
 if(!pn.value||!pp.value)return;
 products.push({n:pn.value,p:+pp.value});
 saveAll();renderProducts();
 pn.value=pp.value="";
}

function addToCart(p){
 let item=cart.find(i=>i.n==p.n);
 item?item.q++:cart.push({n:p.n,p:p.p,q:1});
 renderInvoice();
}

function renderInvoice(){
 invoiceItems.innerHTML="";
 let t=0;
 cart.forEach(i=>{
  t+=i.p*i.q;
  invoiceItems.innerHTML+=`<div class="item">${i.n} × ${i.q}</div>`;
 });
 total.innerText="الإجمالي: "+t;
}

function saveInvoice(){
 if(cart.length==0)return;
 invoices.push({date:new Date().toLocaleString(),items:cart});
 cart=[];renderInvoice();saveAll();
 alert("تم الحفظ");
}

function printInvoice(){
 let w=window.open("");
 w.document.write("<h3>فاتورة</h3>");
 cart.forEach(i=>w.document.write(`<div>${i.n} × ${i.q}</div>`));
 w.document.write(`<b>${total.innerText}</b>`);
 w.print();w.close();
}

function dailyReport(){
 reportBox.innerHTML="عدد الفواتير: "+invoices.length;
}

function saveSettings(){
 settings.shopName=shopInput.value;
 shopName.innerText=settings.shopName;
 saveAll();
}

function saveAll(){
 localStorage.products=JSON.stringify(products);
 localStorage.invoices=JSON.stringify(invoices);
 localStorage.settings=JSON.stringify(settings);
}

shopName.innerText=settings.shopName||"نظام كاشير";
renderProducts();
</script>

</body>
</html>
